



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content="cht">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="zh">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>用户系统API - 个人笔记</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="cyan">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#python" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="个人笔记" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              个人笔记
            </span>
            <span class="md-header-nav__topic">
              
                用户系统API
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="个人笔记" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    个人笔记
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="主页" class="md-nav__link">
      主页
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      编程笔记
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        编程笔记
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../android_index/" title="Android Native" class="md-nav__link">
      Android Native
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cpp_index/" title="C++" class="md-nav__link">
      C++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../kotlin_tomcat/" title="Kotlin For Tomcat" class="md-nav__link">
      Kotlin For Tomcat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deeplearning_index/" title="深度学习" class="md-nav__link">
      深度学习
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      学科
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        学科
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      英语
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        英语
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../english_word/" title="单词" class="md-nav__link">
      单词
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../resources/" title="资源整理" class="md-nav__link">
      资源整理
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      开发文档
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        开发文档
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../regular/" title="文档编写规范" class="md-nav__link">
      文档编写规范
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        用户系统API
      </label>
    
    <a href="./" title="用户系统API" class="md-nav__link md-nav__link--active">
      用户系统API
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#python" title="Python后端实现" class="md-nav__link">
    Python后端实现
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" title="用户系统实体模型设计及说明" class="md-nav__link">
    用户系统实体模型设计及说明
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="用户信息" class="md-nav__link">
    用户信息
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="用户活动" class="md-nav__link">
    用户活动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" title="用户绑定信息" class="md-nav__link">
    用户绑定信息
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" title="用户日志" class="md-nav__link">
    用户日志
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" title="后端个性化配置" class="md-nav__link">
    后端个性化配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api" title="API" class="md-nav__link">
    API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" title="路径" class="md-nav__link">
    路径
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" title="注册" class="md-nav__link">
    注册
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" title="默认注册" class="md-nav__link">
    默认注册
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" title="检查用户名是否已被注册" class="md-nav__link">
    检查用户名是否已被注册
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" title="登录" class="md-nav__link">
    登录
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#java" title="Java后端实现" class="md-nav__link">
    Java后端实现
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" title="用户系统实体模型设计及说明" class="md-nav__link">
    用户系统实体模型设计及说明
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" title="用户信息" class="md-nav__link">
    用户信息
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" title="其他辅助信息" class="md-nav__link">
    其他辅助信息
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#community1" title="community用户系统的结构摘要1" class="md-nav__link">
    community用户系统的结构摘要1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#python" title="Python后端实现" class="md-nav__link">
    Python后端实现
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" title="用户系统实体模型设计及说明" class="md-nav__link">
    用户系统实体模型设计及说明
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="用户信息" class="md-nav__link">
    用户信息
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="用户活动" class="md-nav__link">
    用户活动
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" title="用户绑定信息" class="md-nav__link">
    用户绑定信息
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" title="用户日志" class="md-nav__link">
    用户日志
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" title="后端个性化配置" class="md-nav__link">
    后端个性化配置
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api" title="API" class="md-nav__link">
    API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" title="路径" class="md-nav__link">
    路径
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" title="注册" class="md-nav__link">
    注册
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" title="默认注册" class="md-nav__link">
    默认注册
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" title="检查用户名是否已被注册" class="md-nav__link">
    检查用户名是否已被注册
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" title="登录" class="md-nav__link">
    登录
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#java" title="Java后端实现" class="md-nav__link">
    Java后端实现
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" title="用户系统实体模型设计及说明" class="md-nav__link">
    用户系统实体模型设计及说明
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" title="用户信息" class="md-nav__link">
    用户信息
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" title="其他辅助信息" class="md-nav__link">
    其他辅助信息
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#community1" title="community用户系统的结构摘要1" class="md-nav__link">
    community用户系统的结构摘要1
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>用户系统API</h1>
                
                <h2 id="python">Python后端实现<a class="headerlink" href="#python" title="Permanent link">&para;</a></h2>
<h3 id="_1">用户系统实体模型设计及说明<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<div class="admonition tip">
<p class="admonition-title">暂未使用的值</p>
<p>数据库模型中高亮的行表示因为版本原因暂时没有使用的值。</p>
</div>
<h4 id="_2">用户信息<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<div class="admonition summary">
<p class="admonition-title">version 1.0.1</p>
<p>该表用于记录用户的基础信息，自1.0.1版本后，用户活动记录迁移到另外一张表<mark class="critic">UserActivity</mark>。</p>
<div class="codehilite"><pre><span></span><span class="n">user_type_choices</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;normal&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;admin&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;superadmin&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="nd">@model</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">)</span>
<span class="nd">@search</span>
<span class="n">name</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1"># 用户名，只能包含数字，大小写英文，下划线。（长度限制为2~32个字符）</span>
<span class="n">uid</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>  <span class="c1"># 唯一标识名，由系统自己生成。（uid生成方式：时间戳+hash+10-99的随机数） </span>
<span class="n">password</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>  <span class="c1"># 密码，md5</span>
<span class="n">nickname</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>  <span class="c1"># 昵称，1-32个任意字符</span>
<span class="n">email</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>  <span class="c1"># 邮箱</span>
<span class="n">create_time</span><span class="p">:</span> <span class="n">DateTimeField</span><span class="p">()</span>  <span class="c1"># 创建时间</span>
<span class="n">user_type</span><span class="p">:</span> <span class="n">PositiveSmallIntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">user_type_choices</span><span class="p">)</span>  <span class="c1"># 用户类别，包括&#39;normal&#39;,&#39;admin&#39;,&#39;superadmin&#39;三种值，此信息仅用于管理用户信息，具体授权的操作见配置文件。</span>
<span class="hll"><span class="n">exp</span><span class="p">:</span> <span class="n">PositiveIntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># 用户经验</span>
</span><span class="hll"><span class="n">tags</span><span class="p">:</span> <span class="n">TextField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># 用户认证标签</span>
</span><span class="hll"><span class="n">extras</span><span class="p">:</span> <span class="n">TextField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># 无关紧要的额外的信息，以键值对形式存储，键为str，值为jsonobject/str</span>
</span><span class="nd">@virtual</span>
<span class="n">activities</span><span class="p">:</span> <span class="n">MultiForeignKey</span><span class="p">(</span><span class="n">UserActivity</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;activities&#39;</span><span class="p">)</span>
<span class="nd">@virtual</span>
<span class="n">bindings</span><span class="p">:</span> <span class="n">MultiForeignKey</span><span class="p">(</span><span class="n">UserBinding</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bindings&#39;</span><span class="p">)</span>
<span class="nd">@virtual</span>
<span class="n">logs</span><span class="p">:</span> <span class="n">MultiForeignKey</span><span class="p">(</span><span class="n">UserLog</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;logs&#39;</span><span class="p">)</span>
</pre></div>

<div class="admonition info">
<p class="admonition-title">uid生成算法</p>
<p>取时间戳+用户名的hash值+10-99随机取一个随机数
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_hash</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">md5</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>
    <span class="n">md5</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">md5</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">make_uid</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">get_hash</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span>
</pre></div></p>
</div>
</div>
<details class="summary"><summary>version 1.0.0</summary><p>该表用于记录用户的基础信息</p>
<div class="codehilite"><pre><span></span><span class="nd">@model</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">)</span>
<span class="nd">@search</span>
<span class="n">name</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>  <span class="c1"># 用户名，只能包含数字，大小写英文，下划线。（长度限制为2~32个字符）</span>
<span class="n">uid</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>  <span class="c1"># 唯一标识名，由系统自己生成。（uid生成方式：时间戳+hash+10-99的随机数）</span>
<span class="n">password</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>  <span class="c1"># 密码，取AES加密传输(md5 32位加密)</span>
<span class="n">nickname</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>  <span class="c1"># 昵称，1-32个任意字符</span>
<span class="n">tokens</span><span class="p">:</span> <span class="n">TextField</span><span class="p">()</span>  <span class="c1"># token，用于存储临时的登录信息</span>
<span class="n">email</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>  <span class="c1"># 邮箱</span>
<span class="n">create_time</span><span class="p">:</span> <span class="n">DateTimeField</span><span class="p">()</span>  <span class="c1"># 创建时间</span>
<span class="n">last_time</span><span class="p">:</span> <span class="n">DateTimeField</span><span class="p">()</span>  <span class="c1"># 最后登录的时间</span>
</pre></div>

<div class="admonition fail">
<p class="admonition-title">token</p>
<p>以键值对的形式存储各个软件的目前登录信息，注册的软件写在另外一个数据表[config]内。</p>
<p>token的生成方式为取字符串<code class="codehilite"><span class="n">uid</span><span class="o">:</span><span class="n">password</span><span class="o">(</span><span class="n">md5</span><span class="o">):</span><span class="n">last_time</span></code>进行AES加密，具体过程见附录。</p>
<p>token的存储形式为<mark class="critic">softwarename::devicetype::token::last_ip::last_time</mark>例如：</p>
<div class="codehilite"><pre><span></span>community::mobile::1231adef788231231234dddd::192.142.31.44:222::13213123123
community::pc:123131231312312312312312::192.142.31.44:227::1231413423
</pre></div>

</div>
</details>
<h4 id="_3">用户活动<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<div class="admonition summary">
<p class="admonition-title">version 1.0.1</p>
<p>该表用于记录用户的活动信息</p>
<div class="codehilite"><pre><span></span><span class="n">device_type_choices</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;mobile&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;pc&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;web&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;pad&#39;</span><span class="p">),</span>
<span class="p">)</span>

<span class="nd">@model</span><span class="p">(</span><span class="s1">&#39;UserActivity&#39;</span><span class="p">)</span>
<span class="nd">@search</span>
<span class="n">user</span><span class="p">:</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;user_activities&#39;</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>  <span class="c1"># 外键，对应持有该活动信息用户。</span>
<span class="n">software</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>  <span class="c1"># 对应的软件名称，默认支持&#39;test&#39;和&#39;index&#39;，其他支持需要询问平台配置。</span>
<span class="n">access_ip</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>  <span class="c1"># 最后活动的ip地址</span>
<span class="hll"><span class="c1"># access_uid: CharField(max_length=64)  # -无效- 第一次登录时生成的uid，用于自动登录时的检测所用。</span>
</span><span class="n">device_type</span><span class="p">:</span> <span class="n">PositiveSmallIntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">device_type_choices</span><span class="p">)</span>  <span class="c1"># 设备平台名称，默认支持&#39;mobile&#39;,&#39;pc&#39;,&#39;web&#39;,&#39;pad&#39;四个平台的设备。</span>
<span class="n">access_time</span><span class="p">:</span> <span class="n">DateTimeField</span><span class="p">()</span>  <span class="c1"># 最后活动的时间</span>
</pre></div>

<div class="admonition info">
<p class="admonition-title">token</p>
<p>该表并没有存储token信息，实际上，发给用户的信息将会转译成token</p>
<p>token生成方式：生成字符串，格式为<code class="codehilite">useruid::software::device_type::access_uid::access_time</code>，例如，然后使用AES方式加密该字符串。</p>
<p>除了'test'和'index'外，其他支持的软件需要进行后台注册。</p>
<div class="codehilite"><pre><span></span>123143123123ac123::community::mobile::12313123123113acc::1231231231
123143123123ac123::community::pc::12313123123113acc::1231231231
</pre></div>

</div>
</div>
<h4 id="_4">用户绑定信息<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<div class="admonition summary">
<p class="admonition-title">version 1.0.1</p>
<p>该表用于记录用户的绑定信息，用于提供服务和使用第三方信息登录该软件。</p>
<div class="admonition tip">
<p class="admonition-title">唯一绑定</p>
<p>每个第三方用户绑定是唯一的，即只能绑定在一个用户上，若要解绑，需要验证其他信息。</p>
</div>
<div class="codehilite"><pre><span></span><span class="n">state_choices</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;fail&#39;</span><span class="p">),</span>
<span class="p">)</span>

<span class="nd">@model</span><span class="p">(</span><span class="s1">&#39;UserBinding&#39;</span><span class="p">)</span>
<span class="nd">@search</span>
<span class="n">user</span><span class="p">:</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;bindings&#39;</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>  <span class="c1"># 外键，对应持有该绑定信息的用户</span>
<span class="n">name</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>  <span class="c1"># 绑定平台的名称，绑定的平台需要访问配置信息。</span>
<span class="n">uid</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>  <span class="c1"># 唯一标识符，注意，此字段是唯一绑定的关键信息</span>
<span class="n">password</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>  <span class="c1"># 绑定的密码</span>
<span class="n">state</span><span class="p">:</span> <span class="n">PositiveSmallIntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">state_choices</span><span class="p">)</span>  <span class="c1"># 绑定状态，&#39;success&#39;,&#39;fail&#39;.</span>
</pre></div>

</div>
<h4 id="_5">用户日志<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<div class="admonition summary">
<p class="admonition-title">version 1.0.1</p>
<p>用户的日志信息，每次登录/自动登录或者请求都可能往日志里写一条记录。</p>
<div class="codehilite"><pre><span></span><span class="nd">@model</span><span class="p">(</span><span class="s1">&#39;UserLog&#39;</span><span class="p">)</span>
<span class="nd">@search</span>
<span class="n">user</span><span class="p">:</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;user_log&#39;</span><span class="p">)</span>  <span class="c1"># 外键，对应持有该日志的用户</span>
<span class="n">action_type</span><span class="p">:</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>  <span class="c1"># 用户日志类别，所有兼容的类别都会在设置内写出</span>
<span class="n">time</span><span class="p">:</span> <span class="n">DateTimeField</span><span class="p">()</span>  <span class="c1"># 打log的时间</span>
<span class="n">content</span><span class="p">:</span> <span class="n">TextField</span><span class="p">()</span>  <span class="c1"># 用户日志内容</span>
</pre></div>

<p>预设的日志信息类别、格式和说明</p>
<table>
<thead>
<tr>
<th align="center">action_type</th>
<th align="center">format</th>
<th align="center">description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">login</td>
<td align="center">state=enumof(success/fail)::software=str::access_ip=str::access_time=str</td>
<td align="center">用户登录活动</td>
</tr>
</tbody>
</table>
</div>
<h3 id="_6">后端个性化配置<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<div class="admonition summary">
<div class="codehilite"><pre><span></span><span class="c1"># 模式</span>
<span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>

<span class="c1"># 安全</span>
<span class="n">default_key</span> <span class="o">=</span> <span class="s1">&#39;****************&#39;</span>  <span class="c1"># AES加密的默认密钥</span>

<span class="c1"># 其他配置</span>
<span class="n">software</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;community&#39;</span>  <span class="c1"># 社交软件</span>
    <span class="s1">&#39;myday&#39;</span>  <span class="c1"># 日程软件</span>
<span class="p">)</span>
</pre></div>

</div>
<h3 id="api">API<a class="headerlink" href="#api" title="Permanent link">&para;</a></h3>
<div class="admonition tip">
<p>该部分还没有完成，请耐心等待</p>
</div>
<div class="admonition tip">
<p class="admonition-title">编写格式</p>
<p>请求按照<mark class="critic">yml</mark>的格式书写，格式为</p>
<div class="codehilite"><pre><span></span>route: $route
get:
    $argument1: $description
    ...
post:
    $argument1: $decription
    ...
</pre></div>

<p>返回的json格式如下
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
    <span class="nt">&quot;shortcut&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;jsonobject&quot;</span>
<span class="p">}</span>
</pre></div></p>
<p>然后给出返回的shortcut值和对应的含义，并给出正确的输入和输出样例</p>
</div>
<h4 id="_7">路径<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="err">本地开发环境</span><span class="o">:</span> <span class="n">http</span><span class="o">://</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">8080</span><span class="o">/</span>
<span class="err">测试环境</span><span class="o">:</span> <span class="err">暂未部署</span>
<span class="err">生产环境：暂未部署</span>
</pre></div>

<h4 id="_8">注册<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p>注册分为很多种，有默认的注册，还有平台的注册。</p>
<h5 id="_9">默认注册<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h5>
<div class="admonition info">
<p><strong>请求</strong></p>
<div class="codehilite"><pre><span></span><span class="n">route</span><span class="p">:</span> <span class="s1">&#39;/api/user/create&#39;</span>
<span class="n">post</span><span class="p">(</span><span class="n">get</span> <span class="ow">in</span> <span class="s1">&#39;debug&#39;</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># 用户名，只能包含数字，大小写英文，下划线。（长度限制为2~32个字符）</span>
    <span class="n">nickname</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># 昵称，1-32个任意字符</span>
    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># 密码，md5，以16进制传输，英文字符为小写</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># 邮箱</span>
</pre></div>

<hr />
<div class="admonition info">
<p class="admonition-title">查看用户是否已经被注册</p>
<p>我们对此提供了一个接口<code class="codehilite">check_name</code>用于检查用户名是否已经被注册</p>
</div>
<p><strong>返回值</strong></p>
<table>
<thead>
<tr>
<th align="center">shortcut</th>
<th align="center">msg</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">ae</td>
<td align="center">arguments mismatch.</td>
<td align="left">status=400,参数不匹配</td>
</tr>
<tr>
<td align="center">fe</td>
<td align="center">arguments format error:{0}</td>
<td align="left">status=400,后面会给出详细错误信息，例如:arg(name) is invalid</td>
</tr>
<tr>
<td align="center">ur</td>
<td align="center">the user [{name}] has been registerd.</td>
<td align="left">给出错误信息，表示该用户已经被注册</td>
</tr>
<tr>
<td align="center">ok</td>
<td align="center">ok, you have created a user, let's fun</td>
<td align="left">注册成功</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>样例</strong></p>
<div class="codehilite"><pre><span></span># get
<span class="hll">http://127.0.0.1:8000/api/user/create?name=test<span class="p">&amp;</span>nickname=test1<span class="p">&amp;</span>password=e10adc3949ba59abbe56e057f20f883e<span class="p">&amp;</span>email=example1@gmail.com
</span># post
<span class="hll">http://127.0.0.1:8000/api/user/create
</span>name=test
nickname=test1
password=e10adc3949ba59abbe56e057f20f883e
email=example1@gmail.com
# return
{
    <span class="s2">&quot;msg&quot;</span>: <span class="s2">&quot;ok, you have create a user, let&#39;s fun&quot;</span>, 
    <span class="s2">&quot;shortcut&quot;</span>: <span class="s2">&quot;ok&quot;</span>, 
    <span class="s2">&quot;data&quot;</span>: {
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;test&quot;</span>, 
        <span class="s2">&quot;uid&quot;</span>: <span class="s2">&quot;15631623408ad8757baa8564dc136c1e07507f4a9835&quot;</span>, 
        <span class="s2">&quot;nickname&quot;</span>: <span class="s2">&quot;test1&quot;</span>, 
        <span class="s2">&quot;email&quot;</span>: <span class="s2">&quot;example1@gmail.com&quot;</span>, 
        <span class="s2">&quot;create_time&quot;</span>: <span class="s2">&quot;2019-07-15 11:45:40&quot;</span>, 
        <span class="s2">&quot;user_type&quot;</span>: <span class="s2">&quot;normal&quot;</span>, 
        <span class="s2">&quot;exp&quot;</span>: 0, 
        <span class="s2">&quot;tags&quot;</span>: <span class="s2">&quot;&quot;</span>, 
        <span class="s2">&quot;extras&quot;</span>: <span class="s2">&quot;&quot;</span>
    }
}
</pre></div>

</div>
<h4 id="_10">检查用户名是否已被注册<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<div class="admonition info">
<p><strong>请求</strong></p>
<div class="codehilite"><pre><span></span><span class="n">route</span><span class="p">:</span> <span class="s1">&#39;/api/user/check_name&#39;</span>
<span class="n">get</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># 要查询的用户名</span>
</pre></div>

<hr />
<p><strong>返回值</strong></p>
<table>
<thead>
<tr>
<th align="center">shortcut</th>
<th align="center">msg</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">ae</td>
<td align="center">arguments mismatch</td>
<td align="left">status=400,参数不匹配</td>
</tr>
<tr>
<td align="center">fe</td>
<td align="center">the format of name is invalid.</td>
<td align="left">status=400,输出的姓名格式不正确</td>
</tr>
<tr>
<td align="center">ur</td>
<td align="center">the user [{user}] has been registered.</td>
<td align="left">该用户已被注册</td>
</tr>
<tr>
<td align="center">ok</td>
<td align="center">the user [{user}] has not been registerd.</td>
<td align="left">该用户没有被注册</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>样例</strong></p>
<div class="codehilite"><pre><span></span># get
http://127.0.0.1:8000/api/user/check_name?name=test
# return
{
    <span class="s2">&quot;msg&quot;</span>: <span class="s2">&quot;the user [test] has not been registered.&quot;</span>,
    <span class="s2">&quot;shortcut&quot;</span>: <span class="s2">&quot;ok&quot;</span>
}
</pre></div>

</div>
<h4 id="_11">登录<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<div class="admonition info">
<p><strong>请求</strong></p>
<div class="codehilite"><pre><span></span><span class="n">route</span><span class="p">:</span> <span class="s1">&#39;/api/user/login&#39;</span>
<span class="n">post</span><span class="p">(</span><span class="n">get</span> <span class="ow">in</span> <span class="s1">&#39;debug&#39;</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span><span class="nb">str</span>  <span class="c1"># 登录的用户名，只能包含数字，大小写英文，下划线。（长度限制为2~32个字符）</span>
    <span class="n">password</span><span class="p">:</span><span class="nb">str</span>  <span class="c1"># 密码，md5，以16进制传输，英文字符为小写</span>
    <span class="n">software</span><span class="p">:</span><span class="nb">str</span>  <span class="c1"># 登录软件的名称，支持的软件#个性化设置栏目#</span>
    <span class="n">device_type</span><span class="p">:</span><span class="nb">str</span>  <span class="c1"># 登录的平台，支持&#39;mobile&#39;,&#39;pc&#39;,&#39;web&#39;,&#39;pad&#39;</span>
</pre></div>

<hr />
<p><strong>返回值</strong></p>
<table>
<thead>
<tr>
<th align="center">shortcut</th>
<th align="center">msg</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">ae</td>
<td align="center">arguments mismatch.</td>
<td align="left">status=400,参数不匹配</td>
</tr>
<tr>
<td align="center">fe</td>
<td align="center">arguments format error:{0}</td>
<td align="left">status=400,后面会给出详细错误信息，例如:arg(name) is invalid</td>
</tr>
<tr>
<td align="center">une</td>
<td align="center">user not existed.</td>
<td align="left">该用户不存在</td>
</tr>
<tr>
<td align="center">upe</td>
<td align="center">password error.</td>
<td align="left">用户密码错误</td>
</tr>
<tr>
<td align="center">ok</td>
<td align="center">login ok. let\'s fun.</td>
<td align="left">注册成功</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>样例</strong></p>
<div class="codehilite"><pre><span></span># get
http://127.0.0.1:8000/api/user/login?name=test<span class="p">&amp;</span>password=e10adc3949ba59abbe56e057f20f883e<span class="p">&amp;</span>software=index<span class="p">&amp;</span>device_type=mobile
# post
http://127.0.0.1:8000/api/user/login
name=test
password=e10adc3949ba59abbe56e057f20f883e
software=index
device_type=mobile
# result
{
    <span class="s2">&quot;msg&quot;</span>: <span class="s2">&quot;login ok. let&#39;s fun.&quot;</span>, 
    <span class="s2">&quot;shortcut&quot;</span>: <span class="s2">&quot;ok&quot;</span>, 
    <span class="s2">&quot;data&quot;</span>: {
        <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;test&quot;</span>, 
        <span class="s2">&quot;uid&quot;</span>: <span class="s2">&quot;1563161937098f6bcd4621d373cade4e832627b4f623&quot;</span>, 
        <span class="s2">&quot;nickname&quot;</span>: <span class="s2">&quot;test1&quot;</span>, 
        <span class="s2">&quot;email&quot;</span>: <span class="s2">&quot;example1@gmail.com&quot;</span>, 
        <span class="s2">&quot;create_time&quot;</span>: <span class="s2">&quot;2019-07-15 11:38:57&quot;</span>, 
        <span class="s2">&quot;user_type&quot;</span>: <span class="s2">&quot;normal&quot;</span>, 
        <span class="s2">&quot;exp&quot;</span>: 0, 
        <span class="s2">&quot;tags&quot;</span>: <span class="s2">&quot;&quot;</span>, 
        <span class="s2">&quot;extras&quot;</span>: <span class="s2">&quot;&quot;</span>, 
        <span class="s2">&quot;access_time&quot;</span>: <span class="s2">&quot;2019-07-15 16:57:18&quot;</span>,
        <span class="s2">&quot;token&quot;</span>: <span class="s2">&quot;9e14c58047a47370406a351bc607bbf4c0a4722e0688a5207192f80141c87513278b00f7c1a7ee8462fbc911d9c0109f48765b54107f87a857c1fd65c4ebc6b0e3598ac303d7c824c4724f7bb799d8a321584247fcaed41b539d0eb6268e31ec&quot;</span>
    }
}
</pre></div>

</div>
<h2 id="java">Java后端实现<a class="headerlink" href="#java" title="Permanent link">&para;</a></h2>
<h3 id="_12">用户系统实体模型设计及说明<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<h4 id="_13">用户信息<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<div class="admonition summary">
<p class="admonition-title">version 1.0.1</p>
<div class="codehilite"><pre><span></span><span class="sb">`id`</span><span class="p">:</span> <span class="n">IntegerField</span><span class="p">()</span>  <span class="c1"># 用户的唯一标识符</span>
<span class="n">password</span><span class="p">:</span> <span class="n">TextField</span><span class="p">()</span>  <span class="c1"># 密码</span>
<span class="n">token</span><span class="p">:</span> <span class="n">TextField</span><span class="p">()</span>  <span class="c1"># 用户的token信息</span>
<span class="n">last_login_ip</span><span class="p">:</span> <span class="n">TextField</span><span class="p">()</span>  <span class="c1"># 用户最后一次登录的ip地址</span>
<span class="n">last_login_time</span><span class="p">:</span> <span class="n">TextField</span><span class="p">()</span>  <span class="c1"># 用户最后一次登录的时间，格式为&#39;%y-%M-%d&#39;</span>
<span class="n">email</span><span class="p">:</span> <span class="n">TextField</span><span class="p">()</span>  <span class="c1"># 用户邮箱</span>
<span class="n">log</span><span class="p">:</span> <span class="n">TextField</span><span class="p">()</span>  <span class="c1"># 用户登录的日志</span>
<span class="n">nickname</span><span class="p">:</span> <span class="n">TextField</span><span class="p">()</span>  <span class="c1"># 用户的昵称</span>
</pre></div>

</div>
<h2 id="_14">其他辅助信息<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h2>
<h3 id="community1">community用户系统的结构摘要<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">1</a></sup><a class="headerlink" href="#community1" title="Permanent link">&para;</a></h3>
<div class="admonition summary">
<div class="codehilite"><pre><span></span><span class="cm">/*</span>
<span class="cm">用户系统:</span>
<span class="cm">{</span>
<span class="cm">    登录:</span>
<span class="cm">    [</span>
<span class="cm">        账号密码登录,</span>
<span class="cm">        根据token自动登录,</span>
<span class="cm">        第三方授权登录</span>
<span class="cm">    ]</span>
<span class="cm">    注册:</span>
<span class="cm">    [</span>
<span class="cm">        第三方授权登录补全信息,</span>
<span class="cm">        普通用户信息注册</span>
<span class="cm">    ]</span>
<span class="cm">    用户组:</span>
<span class="cm">    [</span>
<span class="cm">        超级管理员,</span>
<span class="cm">        普通管理员,</span>
<span class="cm">        版块版主,</span>
<span class="cm">        普通用户,</span>
<span class="cm">        封禁用户,</span>
<span class="cm">        游客</span>
<span class="cm">    ]</span>
<span class="cm">    个人信息:</span>
<span class="cm">    [</span>
<span class="cm">        用户id,</span>
<span class="cm">        账户密码,</span>
<span class="cm">        token信息,</span>
<span class="cm">        平台绑定信息,</span>
<span class="cm">        关注版块,</span>
<span class="cm">        学校绑定:</span>
<span class="cm">        [</span>
<span class="cm">            学校代码,</span>
<span class="cm">            学校城市代码,</span>
<span class="cm">            学校名称:</span>
<span class="cm">            [</span>
<span class="cm">                中文,</span>
<span class="cm">                英文,</span>
<span class="cm">                简称</span>
<span class="cm">            ]</span>
<span class="cm">            专业,</span>
<span class="cm">            班级,</span>
<span class="cm">            学号,</span>
<span class="cm">            姓名,</span>
<span class="cm">            社团/组织</span>
<span class="cm">        ],</span>
<span class="cm">        昵称,</span>
<span class="cm">        简介,</span>
<span class="cm">        用户认证:</span>
<span class="cm">        [</span>
<span class="cm">            个人认证,</span>
<span class="cm">            企业认证,</span>
<span class="cm">            普通用户</span>
<span class="cm">        ],</span>
<span class="cm">        个性签名,</span>
<span class="cm">        姓名,</span>
<span class="cm">        邮箱,</span>
<span class="cm">        城市,</span>
<span class="cm">        地址,</span>
<span class="cm">        电话,</span>
<span class="cm">        爱好,</span>
<span class="cm">        关注,</span>
<span class="cm">        粉丝,</span>
<span class="cm">        推文数量,</span>
<span class="cm">        状态:[</span>
<span class="cm">            正常,</span>
<span class="cm">            注销,</span>
<span class="cm">            不活跃,</span>
<span class="cm">            封禁X天</span>
<span class="cm">        ]</span>
<span class="cm">        注册日期,</span>
<span class="cm">        最后一次登录IP,</span>
<span class="cm">        最后一次登录日期,</span>
<span class="cm">        备注信息</span>
<span class="cm">    ]</span>
<span class="cm">}</span>
<span class="cm">推文系统:</span>
<span class="cm">[</span>
<span class="cm">    主要组成部分:</span>
<span class="cm">    [</span>
<span class="cm">        作者,</span>
<span class="cm">        发布时间,</span>
<span class="cm">        (标题),</span>
<span class="cm">        正文,</span>
<span class="cm">        图片,</span>
<span class="cm">        转发链,</span>
<span class="cm">        回复,</span>
<span class="cm">        点赞,</span>
<span class="cm">    ],</span>
<span class="cm">    附加部分:</span>
<span class="cm">    [</span>
<span class="cm">        编辑历史,</span>
<span class="cm">        状态,</span>
<span class="cm">        可见性:</span>
<span class="cm">        [</span>
<span class="cm">            仅自己可见,</span>
<span class="cm">            部分人可见,</span>
<span class="cm">            部分人不可见</span>
<span class="cm">        ],</span>
<span class="cm">        是否可评论,</span>
<span class="cm">        是否已删除,</span>
<span class="cm">        点击量,</span>
<span class="cm">        浏览量,</span>
<span class="cm">        被举报信息,</span>
<span class="cm">        附加信息</span>
<span class="cm">    ]</span>
<span class="cm">]</span>
<span class="cm">*/</span>
</pre></div>

</div>
<div class="footnote">
<hr />
<ol>
<li id="fn:2">
<p>详情见<a href="https://github.com/TropicalTeamYard/TTY-Community-Service/blob/master/src/servlet/Api.java">Github页面</a>，本页面可能更新并不及时。&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../regular/" title="文档编写规范" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                文档编写规范
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.245445c6.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>